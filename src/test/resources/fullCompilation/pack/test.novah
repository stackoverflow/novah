module pack.test

import pack.namespace1 ( Foo )

foreign import type java.io.File
foreign import type java.util.ArrayList
foreign import new ArrayList() as newArrayList
foreign import ArrayList.add(String)

type Day = Weekday | Weekend

type Result k e = Ok k | Err e

type Triple a b c = Triple a b c Int String

bar : Unit -> Option Foo
bar () = Some 0

pub
num = 2

pub
y = 45.8E12

b2 = b

b = true

c = if true then "" else d

d = do
  4
  z
  "asd"

z = "something"

i = 99

l _ = let l1 = toString 4
          l2 = toString l1
      in l2

w = \x -> x

myFun : Option (Option String) -> String
myFun x = case x of
  Some (Some v) -> v
  Some None -> "some nope"
  None -> "nope"

lamb : Boolean -> String -> Unit
lamb x x2 = do
  if x then
    println x2
  else
    println (toString x)
  Some "a"
  println (toString (Some "a"))

rec = { name: "Mario", lastName: "Brother", age: 33 }

runRecords () = do
  println (toString rec)
  let plus = { "which game": "Super Mario Brothers" | rec }
  println (toString plus)
  let minus = { - name | rec }
  println (toString minus)
  println rec.name
  println (toString rec.age)
  let dup = { name: "Mario", name: "Luigi", name: "Peach", game: "Bros" }
  println (toString dup)
  println dup.name

vec = [1, 2, 3, 4]

runVectors () = do
  println (toString vec)
  let vs = ["many", "different", "strings"]
  println (toString vs)

set = #{1, 2, 3, 4}

runSets () = do
  println (toString set)
  let ss = #{"many", "different", "strings"}
  println (toString ss)

run () = do
  let arr = newArrayList ()
  add arr "asd"
  add arr "oops"
  println (toString arr)

main _ = do
  println "running novah"
  runSets ()
  //println (myFun (Some (Some "fun")))